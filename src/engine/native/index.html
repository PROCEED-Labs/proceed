<!doctype html>
<head>
  <script text="text/javascript" src="bundle.js" defer></script>
  <script>
    window.document.addEventListener('DOMContentLoaded', () => {
      class CustomIPC extends PROCEED.IPC {
        emit(taskID, taskName, args) {
          console.log(taskName, args);

          // Hardcoded test case
          if (taskName === 'read' || taskName === 'write') {
            if (args[0] === 'processes/bf5fda88-ed36-40fa-a5d0-9474644f2667') {
              this.receive(taskID, [null, 'process_bf5fda88-ed36-40fa-a5d0-9474644f2667']);
            } else if (args[0] === 'capabilities/names') {
              this.receive(taskID, [null, ['has-screen']]);
            } else if (args[0] === 'process_bf5fda88-ed36-40fa-a5d0-9474644f2667/bpmn') {
              this.receive(taskID, [
                null,
                `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<bpmn2:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:bioc=\"http://bpmn.io/schema/bpmn/biocolor/1.0\" xmlns:proceed=\"https://docs.proceed-labs.org\" id=\"sample-diagram\" name=\"Test\" targetNamespace=\"http://bpmn.io/schema/bpmn\" expressionLanguage=\"javascript\" typeLanguage=\"json\" exporter=\"PROCEED Management System\" exporterVersion=\"0.1.0\" xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\">\n  <bpmn2:process id=\"bf5fda88-ed36-40fa-a5d0-9474644f2667\" name=\"PROCEED Main Process\" processType=\"Private\" isExecutable=\"true\">\n    <bpmn2:startEvent id=\"StartEvent_1\">\n      <bpmn2:outgoing>SequenceFlow_1u07wle</bpmn2:outgoing>\n    </bpmn2:startEvent>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1u07wle\" sourceRef=\"StartEvent_1\" targetRef=\"Task_1nch8yq\"/>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1r4ma8g\" sourceRef=\"Task_1nch8yq\" targetRef=\"ExclusiveGateway_16ko3uz\"/>\n    <bpmn2:parallelGateway id=\"ExclusiveGateway_16ko3uz\">\n      <bpmn2:incoming>SequenceFlow_1r4ma8g</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1e61mdk</bpmn2:outgoing>\n      <bpmn2:outgoing>SequenceFlow_0ybdx4u</bpmn2:outgoing>\n      <bpmn2:outgoing>SequenceFlow_1rbsgmi</bpmn2:outgoing>\n    </bpmn2:parallelGateway>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1e61mdk\" sourceRef=\"ExclusiveGateway_16ko3uz\" targetRef=\"Task_04hyi85\"/>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_144sn4f\" sourceRef=\"Task_1d98r97\" targetRef=\"EndEvent_12jsa3g\"/>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0lnenp4\" sourceRef=\"Task_04hyi85\" targetRef=\"EndEvent_0h0pr9b\"/>\n    <bpmn2:endEvent id=\"EndEvent_0h0pr9b\">\n      <bpmn2:incoming>SequenceFlow_0lnenp4</bpmn2:incoming>\n    </bpmn2:endEvent>\n    <bpmn2:endEvent id=\"EndEvent_12jsa3g\">\n      <bpmn2:incoming>SequenceFlow_144sn4f</bpmn2:incoming>\n    </bpmn2:endEvent>\n    <bpmn2:scriptTask id=\"Task_1nch8yq\" scriptFormat=\"Javascript\">\n      <bpmn2:incoming>SequenceFlow_1u07wle</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1r4ma8g</bpmn2:outgoing>\n      <bpmn2:script><![CDATA[services.console.log('INIT');\nnext();]]></bpmn2:script>\n    </bpmn2:scriptTask>\n    <bpmn2:userTask id=\"Task_04hyi85\" name=\"Test 1\">\n      <bpmn2:incoming>SequenceFlow_1e61mdk</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_0lnenp4</bpmn2:outgoing>\n    <bpmn2:extensionElements><proceed:capabilities><proceed:capability>has-screen</proceed:capability></proceed:capabilities></bpmn2:extensionElements></bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_0ybdx4u\" sourceRef=\"ExclusiveGateway_16ko3uz\" targetRef=\"Task_1d98r97\"/>\n    <bpmn2:userTask id=\"Task_1d98r97\">\n      <bpmn2:incoming>SequenceFlow_0ybdx4u</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_144sn4f</bpmn2:outgoing>\n    <bpmn2:extensionElements><proceed:capabilities><proceed:capability>has-screen</proceed:capability></proceed:capabilities></bpmn2:extensionElements></bpmn2:userTask>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1rbsgmi\" sourceRef=\"ExclusiveGateway_16ko3uz\" targetRef=\"Task_1xqm7ay\"/>\n    <bpmn2:userTask id=\"Task_1xqm7ay\" name=\"Test 3\">\n      <bpmn2:incoming>SequenceFlow_1rbsgmi</bpmn2:incoming>\n      <bpmn2:outgoing>SequenceFlow_1n5o926</bpmn2:outgoing>\n    <bpmn2:extensionElements><proceed:capabilities><proceed:capability>has-screen</proceed:capability></proceed:capabilities></bpmn2:extensionElements></bpmn2:userTask>\n    <bpmn2:endEvent id=\"EndEvent_1crog56\">\n      <bpmn2:incoming>SequenceFlow_1n5o926</bpmn2:incoming>\n    </bpmn2:endEvent>\n    <bpmn2:sequenceFlow id=\"SequenceFlow_1n5o926\" sourceRef=\"Task_1xqm7ay\" targetRef=\"EndEvent_1crog56\"/>\n  </bpmn2:process>\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"bf5fda88-ed36-40fa-a5d0-9474644f2667\">\n      <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"412\" y=\"240\" width=\"36\" height=\"36\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1u07wle_di\" bpmnElement=\"SequenceFlow_1u07wle\">\n        <di:waypoint x=\"448\" y=\"258\"/>\n        <di:waypoint x=\"498\" y=\"258\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1r4ma8g_di\" bpmnElement=\"SequenceFlow_1r4ma8g\">\n        <di:waypoint x=\"598\" y=\"258\"/>\n        <di:waypoint x=\"648\" y=\"258\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"ParallelGateway_0qxihpo_di\" bpmnElement=\"ExclusiveGateway_16ko3uz\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"648\" y=\"233\" width=\"50\" height=\"50\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1e61mdk_di\" bpmnElement=\"SequenceFlow_1e61mdk\">\n        <di:waypoint x=\"698\" y=\"258\"/>\n        <di:waypoint x=\"766\" y=\"258\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_144sn4f_di\" bpmnElement=\"SequenceFlow_144sn4f\">\n        <di:waypoint x=\"866\" y=\"368\"/>\n        <di:waypoint x=\"934\" y=\"368\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0lnenp4_di\" bpmnElement=\"SequenceFlow_0lnenp4\">\n        <di:waypoint x=\"866\" y=\"258\"/>\n        <di:waypoint x=\"900\" y=\"258\"/>\n        <di:waypoint x=\"900\" y=\"222\"/>\n        <di:waypoint x=\"934\" y=\"222\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"EndEvent_0h0pr9b_di\" bpmnElement=\"EndEvent_0h0pr9b\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"934\" y=\"204\" width=\"36\" height=\"36\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"EndEvent_12jsa3g_di\" bpmnElement=\"EndEvent_12jsa3g\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"934\" y=\"350\" width=\"36\" height=\"36\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"ScriptTask_19zcujq_di\" bpmnElement=\"Task_1nch8yq\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"498\" y=\"218\" width=\"100\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"UserTask_0e8okre_di\" bpmnElement=\"Task_04hyi85\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"766\" y=\"218\" width=\"100\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_0ybdx4u_di\" bpmnElement=\"SequenceFlow_0ybdx4u\">\n        <di:waypoint x=\"673\" y=\"283\"/>\n        <di:waypoint x=\"673\" y=\"368\"/>\n        <di:waypoint x=\"766\" y=\"368\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_0iznjc9_di\" bpmnElement=\"Task_1d98r97\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"766\" y=\"328\" width=\"100\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1rbsgmi_di\" bpmnElement=\"SequenceFlow_1rbsgmi\">\n        <di:waypoint x=\"673\" y=\"283\"/>\n        <di:waypoint x=\"673\" y=\"478\"/>\n        <di:waypoint x=\"766\" y=\"478\"/>\n      </bpmndi:BPMNEdge>\n      <bpmndi:BPMNShape id=\"UserTask_1m14bgv_di\" bpmnElement=\"Task_1xqm7ay\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"766\" y=\"438\" width=\"100\" height=\"80\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNShape id=\"EndEvent_1crog56_di\" bpmnElement=\"EndEvent_1crog56\" bioc:fill=\"rgba(31, 119, 180, 0.5)\">\n        <dc:Bounds x=\"934\" y=\"460\" width=\"36\" height=\"36\"/>\n      </bpmndi:BPMNShape>\n      <bpmndi:BPMNEdge id=\"SequenceFlow_1n5o926_di\" bpmnElement=\"SequenceFlow_1n5o926\">\n        <di:waypoint x=\"866\" y=\"478\"/>\n        <di:waypoint x=\"934\" y=\"478\"/>\n      </bpmndi:BPMNEdge>\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</bpmn2:definitions>`,
              ]);
            } else {
              this.receive(taskID, [null, null]);
            }
          }
        }
      }
      PROCEED.init({}, new CustomIPC());
      PROCEED.test();
    });
  </script>
</head>
<body>
  <h1>PROCEED</h1>
</body>
